<!DOCTYPE html>

<html>
    <head>
{{> @head.mst }}

    </head>

    <body>
        <div class="container">

		{{> @navbar.mst }}
		<h1>Pages</h1>
		<table class="table table-striped">
			<thead>
   				 <tr>
			        <th>Name</th>
					<th>Action</th>
			     </tr>
			</thead>						     
    		<tbody id="page-list">
    			{{#entries}}
					<tr id="page-{{id}}">
						<td><a href="/page/{{id}}" class="attachment">{{title}}</a></td>
	  					<td><a href="/page/edit/{{id}}" aria-label="Edit">edit</a>|<a href="javascript:void(0)" class="delete-page-button" aria-label="Delete">delete</a></td>
					</tr>
				{{/entries}}	
			</tbody>
 		</table>	
		 <ul class="pagination pagination-sm">
		 {{#pages}}
		 {{#active}}
		 <li class="active">
		 {{/active}}
		 {{^active}}
		 <li>
		 {{/active}}
		 <a href="{{href}}">{{text}}</a>
		 </li>
		 {{/pages}}
       </div>

        <script src="js/jquery-3.1.1.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/login.js"></script>
        <script type="text/javascript">
  			$(document).ready(function() {
  			
  			$('.delete-page-button').click( function() {
				var id = $(this).closest('tr').attr('id').substring(5) ;
				 $.ajax({
	        		url: '/page/delete/',
			        type: 'POST',
	        		data: { 'id': id },
	        		cache: false,
	        		success: function(data, textStatus, jqXHR)
	        		{
	        			$('#page-'+ id).remove() ;
			        },
	        		error: function(jqXHR, textStatus, errorThrown)
	        		{
	        		    // Handle errors here
	        		    console.log('ERRORS: ' + textStatus);
	        		    // STOP LOADING SPINNER
	        		}
			    }) ;
				
			});
  			
  			}) ;
  		</script>	
    </body>
</html>
