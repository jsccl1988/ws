<!DOCTYPE html>
<html>
    <head>
{{> @head.mst }}

    </head>

    <body>
        <div class="container">

		{{> @navbar.mst }}
		
		<ul class="nav nav-tabs">
			<li class="active"><a href="#edit" data-toggle="tab">Page</a></li>
			<li><a href="#preview" data-toggle="tab">Preview</a></li>
		</ul>
		
            
         <div class="tab-content clearfix" style="margin-top: 10px">
            <div class="tab-pane active" id="edit">
             	 <form id="edit-content" action="/page/publish/" method="POST">
  					<div class="form-group">
    					<label class="control-label" for="title">Title:</label>
						    <input class="form-control" name="title" value="{{page.title}}">
				  	</div>
 					<div class="form-group">
    					<label class="control-label" for="title">Permalink:</label>
						    <input class="form-control" name="permalink" value="{{page.permalink}}">
				  	</div>
				  	<div class="form-group">
				    	<label for="Content">Content:</label>
					    <textarea class="mce-editable form-control" name="content" id="content">{{{page.content}}}</textarea>
				   </div>
				   <input type="hidden" name="id" id="page_id" value="{{page.id}}">
				   <p class="form-control-static" id="message"></p>

				    
					<button type="submit" class="btn btn-default">Publish</button>
				</form> 
	   		</div>
		   		
		   	 <div class="tab-pane" id="preview">
            	Preview
	   		</div>

       </div>

        <script src="js/jquery-3.1.1.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/login.js"></script>
        <script language="javascript" type="text/javascript" src="js/tinymce/js/tinymce/tinymce.min.js"></script>

        <script type="text/javascript">
  			$(document).ready(function() {
  			  			
  			
	        {{> @tinymce.mst }}
	        
	        $("#edit-content").submit(function(e) {
	            var f = $(this) ;
	          	
            	$.ajax({
                	 type: 'POST',
                	 url: f.attr("action"),
                	 dataType: 'json',
	                 data: f.serialize(),
    	             success: function (data, textStatus, request) {
    	             	$('input[name=id]').val(data.id) ;
    	                 $("#preview").html($("#content").val());
    	                 $('#message').html(data.msg).addClass("alert alert-success") ;
    	             },
    	             error: function (req, status, error) {
    	                 alert&("Error occurred!");
    	             }
    	        });
    	        
    	        e.preventDefault();

    		});
	        
			
		});
		
		</script>
    </body>
</html>
